<template>
  <div>
    <!-- 触发按钮 -->
    <a-button type="primary" @click="showModal">打开风险提示弹框</a-button>

    <!-- 风险提示响应操作弹框 -->
    <a-modal
      v-model:open="visible"
      title="风险提示响应操作"
      width="1200px"
      :footer="null"
      centered
    >
      <!-- 漏洞信息表格 -->
      <a-table
        :columns="columns"
        :data-source="dataSource"
        :pagination="false"
        bordered
        size="middle"
        :scroll="{ x: 1100 }"
      >
        <template #bodyCell="{ column, text }">
          <template v-if="column.dataIndex === 'level'">
            <span style="color: #ff4d4f">{{ text }}</span>
          </template>
        </template>
      </a-table>

      <!-- 选择操作区域 -->
      <div class="operation-section">
        <h4>选择操作</h4>
        <a-row :gutter="16" style="margin-bottom: 24px">
          <a-col :span="12">
            <div class="form-item">
              <span class="label">选择应用系统：</span>
              <a-select
                v-model:value="selectedSystem"
                style="width: 100%"
                placeholder="请选择应用系统"
                allow-clear
              >
                <a-select-option value="system1">系统1</a-select-option>
                <a-select-option value="system2">系统2</a-select-option>
              </a-select>
            </div>
          </a-col>
          <a-col :span="12">
            <div class="form-item">
              <span class="label">选择属主：</span>
              <a-select
                v-model:value="selectedOwner"
                style="width: 100%"
                placeholder="请选择属主"
                allow-clear
              >
                <a-select-option value="owner1">属主1</a-select-option>
                <a-select-option value="owner2">属主2</a-select-option>
              </a-select>
            </div>
          </a-col>
        </a-row>

        <!-- 底部按钮 -->
        <div class="footer-buttons">
          <a-button @click="handleCancel" size="large">
            <CloseCircleOutlined /> 取消
          </a-button>
          <a-button type="primary" @click="handleConfirm" size="large">
            <CheckOutlined /> 确认
          </a-button>
        </div>
      </div>
    </a-modal>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { CheckOutlined, CloseCircleOutlined } from '@ant-design/icons-vue';
import { message } from 'ant-design-vue';

// 弹框显示状态
const visible = ref(false);

// 选择的系统和属主
const selectedSystem = ref(undefined);
const selectedOwner = ref(undefined);

// 表格列配置
const columns = [
  {
    title: '漏洞ID',
    dataIndex: 'id',
    width: 150,
    align: 'center'
  },
  {
    title: '漏洞来源',
    dataIndex: 'source',
    width: 180,
    align: 'center'
  },
  {
    title: '漏洞级别',
    dataIndex: 'level',
    width: 100,
    align: 'center'
  },
  {
    title: '漏洞名称',
    dataIndex: 'name',
    width: 300,
    align: 'center'
  },
  {
    title: '漏洞类型',
    dataIndex: 'type',
    width: 150,
    align: 'center'
  },
  {
    title: '发布时间',
    dataIndex: 'publishTime',
    width: 180,
    align: 'center'
  }
];

// 表格数据
const dataSource = [
  {
    key: '1',
    id: 'QT032016001402',
    source: '172.19.208.6:25060',
    level: '高危',
    name: 'NTP服务存在反射放大DOS攻击漏洞',
    type: 'WEB应用漏洞',
    publishTime: '2025-09-01 17:22:12'
  }
];

// 显示弹框
const showModal = () => {
  visible.value = true;
};

// 取消操作
const handleCancel = () => {
  visible.value = false;
  selectedSystem.value = undefined;
  selectedOwner.value = undefined;
};

// 确认操作
const handleConfirm = () => {
  if (!selectedSystem.value || !selectedOwner.value) {
    message.warning('请选择应用系统和属主');
    return;
  }
  
  message.success('操作成功');
  visible.value = false;
  selectedSystem.value = undefined;
  selectedOwner.value = undefined;
};
</script>

<style scoped>
/* 操作区域样式 */
.operation-section {
  margin-top: 24px;
  padding: 20px;
  background: #fafafa;
  border-radius: 4px;
}

.operation-section h4 {
  margin-bottom: 16px;
  font-size: 16px;
  font-weight: 500;
}

.form-item {
  display: flex;
  align-items: center;
}

.form-item .label {
  min-width: 120px;
  margin-right: 8px;
  font-weight: 500;
}

/* 底部按钮样式 */
.footer-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 24px;
}

.footer-buttons .ant-btn {
  min-width: 100px;
}

/* 自定义表格样式 */
:deep(.ant-table) {
  font-size: 14px;
}

:deep(.ant-table-thead > tr > th) {
  background: #f0f2f5;
  font-weight: 600;
}

:deep(.ant-table-tbody > tr > td) {
  padding: 12px;
}

:deep(.ant-modal-header) {
  border-bottom: 1px solid #f0f0f0;
}

:deep(.ant-modal-title) {
  font-size: 18px;
  font-weight: 500;
}
</style>